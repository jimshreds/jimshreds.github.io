Project: Personal Jekyll blog used as a GitHub Pages site

Purpose
- This repository is a single-user Jekyll site (GitHub Pages) that publishes posts in `_posts/` and uses layouts in `_layouts/`.
- AI helpers should make edits that preserve Jekyll front-matter, URL structure, and the existing HTML/layout semantics.

Big picture
- Static site generated by Jekyll. Content lives in `_posts/`, categories in `_category/`, layouts in `_layouts/`, and site config in `_config.yml`.
- Published site lives in `_site/` (generated) and should not be edited directly — changes belong in source files.
- Typical edits: add/update markdown posts, tweak layouts, fix styles under `css/`, or update Top-level files like `index.html` and `CNAME`.

Important files and conventions
- `_posts/YYYY-MM-DD-title.md`: each post begins with YAML front-matter (layout, title, date, categories). Preserve front-matter keys and date formats.
- `_layouts/*.html`: Liquid templates used to render posts/pages. Keep Liquid tags and include semantics intact.
- `_config.yml`: global Jekyll config. Avoid changing site-wide settings without explicit user consent.
- `CNAME`: contains the custom domain; don't remove or change unless asked.
- `feed.xml`, `feed.radio.xml`: RSS/Feed templates — update carefully when changing post metadata.

Build & test workflow
- Local build: run `bundle install` then `bundle exec jekyll serve` from the repository root (macOS/zsh). This mirrors GitHub Pages rendering.
- Avoid committing the generated `_site/` directory. If present, it's fine to read but not edit.

Editing rules for AI agents
- Preserve front-matter exact keys: `layout`, `title`, `date`, `categories`. When adding posts, use `YYYY-MM-DD-slug.md` in `_posts/`.
- For content edits: do not alter existing permalinks or slugs unless the user requests; changing file name or front-matter `date`/`title` changes URLs.
- When updating layouts, keep Liquid tags (e.g., `{{ content }}`, `{% for post in site.posts %}`) semantics and spacing consistent.
- When updating CSS, prefer adding small scoped rules rather than wholesale replacements.

Examples from this repo
- Post example: `_posts/2025-09-14-radioshow.md` contains front-matter and an iframe embed. When adding a similar post, copy the same structure and keep external embed URLs intact.
- Layout usage: `_layouts/post.html` controls how posts render. Change here to alter post appearance site-wide.

Conservative defaults
- If a change might affect the live site structure (permalinks, CNAME, `_config.yml`), propose edits and wait for confirmation.
- When in doubt, create a new file or patch under a clear prefix (e.g., `draft-` or add a comment at the top) rather than deleting or renaming.

Do not modify
- Do not edit `_site/` files; they are generated. Do not remove `Gemfile` or `Gemfile.lock` unless updating dependencies with explicit consent.

Search & discovery
- Key dirs to inspect for context: `_posts/`, `_layouts/`, `_category/`, `css/`, and root files like `index.html`, `_config.yml`, `CNAME`.

When adding features
- For new features that require dependencies (Ruby gems, JS), propose changes and include exact `bundle`/`npm` commands and `Gemfile` updates.

Commit message style
- Use concise commit messages prefixed by area: `post: Add 2025-09-14 radioshow`, `layout: Fix post meta spacing`, `css: Tweak header styles`.

If you need clarification
- Ask the maintainer whether the change should be live (merge to master) or kept as a draft branch. Mention visible effects on the homepage, feeds, or CNAME.

Maintenance notes
- The site contains many historical posts; prefer non-destructive edits. When bulk editing posts, run a local `bundle exec jekyll build` to verify no Liquid errors.

Podcast feed automation
- `scripts/fetch_archive_metadata.py` — helper script that extracts an Archive.org identifier from a post (or accepts `--id`) and injects `audio_url`, `audio_length`, `audio_mime`, and `itunes_duration` into the post front-matter.
- Run single post: `python3 scripts/fetch_archive_metadata.py _posts/2025-08-30-radioshow.md`
- Batch (dry-run): `python3 scripts/fetch_archive_metadata.py --all --dry-run`
- Options: `--backup` (create .bak), `--dry-run`, `--head-fallback` (use HTTP HEAD to get Content-Length when metadata lacks size).
- CI: `.github/workflows/podcast-metadata.yml` runs the script in dry-run, builds the site, and validates `_site/feed.podcast.xml` is well-formed.

End of file
